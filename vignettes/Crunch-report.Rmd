---
title: "Data Crunching Report: crunch- Draft not for distribution. "
author: "Generated with [Koboloader](https://unhcr.github.io/koboloadeR/docs) "
output:
  rmarkdown::html_vignette:
    toc: yes
    fig_width: 8
    fig_height: 6
vignette: >
  %\VignetteIndexEntry{Trends analysis}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


```{r setup, include = FALSE, echo = FALSE, warning = FALSE, message = FALSE}
mainDir <- getwd()
mainDirroot <- substring(mainDir, 0 , nchar(mainDir) - 10)
using <- function(...) {
libs <- unlist(list(...))
req <- unlist(lapply(libs,require,character.only = TRUE))
      need <- libs[req == FALSE]
        if (length(need) > 0) { 
        install.packages(need, repos = 'http://cran.us.r-project.org')
         lapply(need,require,character.only = TRUE)
    }
  }



## Load all required packages
using('tidyverse', 'ggthemes', 'plyr', 'ggrepel', 'viridis', 'RColorBrewer', 'extrafont', 'corrplot', 'reshape2',
      'scales', 'survey', 'knitr', 'rmarkdown', 'ggpubr', 'grid', 'jtools', 'moments', 'koboloadeR')
options(scipen = 999) # turn-off scientific notation like 1e+48
## Provide below the name of the form in xsl form - format should be xls not xlsx
form <- "form.xlsx"
dico <- readr::read_csv(paste0(mainDirroot,"/data/dico_",form,".csv"))
MainDataFrame <- readr::read_csv(paste0(mainDirroot,"/data/MainDataFrame_encoded.csv"))
data <- readr::read_csv(paste0(mainDirroot,"/data-raw/MainDataFrame.csv"))


## label Variables
MainDataFrame <- kobo_label(MainDataFrame , dico)


## Set up ordinal Variables
list.ordinal <- unique(dico[ dico$listname == "cp13" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$cp13 <- factor(MainDataFrame$cp13, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "cp20" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$cp20 <- factor(MainDataFrame$cp20, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "cp6" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$cp6 <- factor(MainDataFrame$cp6, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "cp7" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$cp7 <- factor(MainDataFrame$cp7, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "cp8" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$cp8 <- factor(MainDataFrame$cp8, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "drk1" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$drk1 <- factor(MainDataFrame$drk1, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "exc7" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$exc7 <- factor(MainDataFrame$exc7, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "exc7new" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$exc7new <- factor(MainDataFrame$exc7new, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "aoj11" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$aoj11 <- factor(MainDataFrame$aoj11, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "aoj12" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$aoj12 <- factor(MainDataFrame$aoj12, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "b1" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$b1 <- factor(MainDataFrame$b1, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "b12" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$b12 <- factor(MainDataFrame$b12, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "b13" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$b13 <- factor(MainDataFrame$b13, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "b18" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$b18 <- factor(MainDataFrame$b18, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "b2" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$b2 <- factor(MainDataFrame$b2, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "b21" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$b21 <- factor(MainDataFrame$b21, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "b21a" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$b21a <- factor(MainDataFrame$b21a, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "b3" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$b3 <- factor(MainDataFrame$b3, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "b32" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$b32 <- factor(MainDataFrame$b32, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "b37" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$b37 <- factor(MainDataFrame$b37, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "b4" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$b4 <- factor(MainDataFrame$b4, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "b47a" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$b47a <- factor(MainDataFrame$b47a, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "b6" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$b6 <- factor(MainDataFrame$b6, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "eff1" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$eff1 <- factor(MainDataFrame$eff1, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "eff2" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$eff2 <- factor(MainDataFrame$eff2, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "it1" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$it1 <- factor(MainDataFrame$it1, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "mil10a" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$mil10a <- factor(MainDataFrame$mil10a, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "mil10e" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$mil10e <- factor(MainDataFrame$mil10e, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "np1" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$np1 <- factor(MainDataFrame$np1, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "sd2new2" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$sd2new2 <- factor(MainDataFrame$sd2new2, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "sd3new2" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$sd3new2 <- factor(MainDataFrame$sd3new2, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "sd6new2" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$sd6new2 <- factor(MainDataFrame$sd6new2, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "q5a" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$q5a <- factor(MainDataFrame$q5a, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "d1" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$d1 <- factor(MainDataFrame$d1, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "d2" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$d2 <- factor(MainDataFrame$d2, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "d3" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$d3 <- factor(MainDataFrame$d3, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "d4" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$d4 <- factor(MainDataFrame$d4, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "d5" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$d5 <- factor(MainDataFrame$d5, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "d6" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$d6 <- factor(MainDataFrame$d6, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "e5" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$e5 <- factor(MainDataFrame$e5, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "gi0" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$gi0 <- factor(MainDataFrame$gi0, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "gi0n" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$gi0n <- factor(MainDataFrame$gi0n, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "pn4" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$pn4 <- factor(MainDataFrame$pn4, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "redist1" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$redist1 <- factor(MainDataFrame$redist1, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "redist2a" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$redist2a <- factor(MainDataFrame$redist2a, levels = list.ordinal)
list.ordinal <- unique(dico[ dico$listname == "redist3" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
MainDataFrame$redist3 <- factor(MainDataFrame$redist3, levels = list.ordinal)


## Create weighted survey object
MainDataFrame.survey <- survey::svydesign(ids = ~ 1 ,  data = MainDataFrame )

```


# Crunching step



This data crunching report allows to quickly explore the results of the survey that can be regenerated as needed.

The objective of this report is to allow to quickly identify potential patterns in your dataset.

A quick screening of this initial report should allow to select the most meaningful graphs.

The crunching process produces a lot of visuals. Therefore it is key to carefully select the most relevant visual that will be presented for potential interpretation in the next step. A typical data interpretation session shall not last more than 2hours and include more than 60 visuals to look at in order to keep participants with a good focus level.
 
In order to guide this selection phase, the data crunching expert and report designer, in collaboration with the data analysis group, can use the following elements:
 
  *  For numeric value, check the frequency distributions of each variable to average, deviation, including outliers and oddities
 
  *  For categorical variables, check for unexpected values: any weird results based on common sense expectations
 
  *  Use correlation analysis to check for potential contradictions in respondents answers to different questions for identified associations (chi-square)
 
  *  Always, Check for missing data (NA) or "%of respondent who answered" that you cannot confidently explain
 
  *  Check unanswered questions, that corresponds to unused skip logic in the questionnaire: For instance, did a person who was never displaced answer displacement-related questions? Were employment-related answers provided for a toddler?
 
When analyzing those representations in a collective setting during data interpretation sessions, you may:  
 
  *  __Reflect__: question data quality and/or make suggestions to adjust questions, identify additional cleaning steps;   

  *  __Interpret__: develop qualitative interpretations of data patterns;     

  *  __Recommend__: suggest recommendations in terms of programmatic adjustment;    

  *  __Classify__: define level of sensitivity for certain topics if required;     

The report can be regenerated as needed by:  
  *  adjusting the report configuration in the xlsform to break it into report and chapter;   

  *  configuring disaggregation & correlation for each question;   

  *  revising the data cleansing based on the cleaning log;   
 
  *  appending calculated indicators to your data frame to reshape variable - also called feature engineering. 


# Dataset description

__Title of the study:__  Latin American Public Opinion Project  


__Abstract:__  Blablablablablabla 


__Rights & Disclaimer:__  Latin American Public Opinion Project 


__Country where the study took place:__  NA 


__Geographic Coverage for the study within the country:__  NA 


__Kind of Data:__  ssd 


__Number of records in the main data frame__: `r nrow(MainDataFrame)`


__Period of data collection__: between `r min(as.Date(MainDataFrame$today, format = "%Y-%m-%d"))` and `r max(as.Date(MainDataFrame$today, format = "%Y-%m-%d"))`


__Documented cleaning__:  Blablablablablabla 



__Entity being analyzed in the study:__  HousingUnit 


__Procedure, technique, or mode of inquiry used to attain the data:__  Interview.FaceToFace.CAPI 


__Study Universe:__  (i.e. group of persons or other elements that are the object of research and to which any analytic results refer: Refugee Survey in Country x 


#  Civic and Political Engagement


 
## Attendance at Meetings of Political Parties
__Interpretation Hint__: NA


Single choice question 


```{r cp13.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=4, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$cp13))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "cp13" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "cp13"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$cp13, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$cp13,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ cp13, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "cp13" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Meetings of Political Parties",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r cp131.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~cp13 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Meetings of Political Parties (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r cp132.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~cp13 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Meetings of Political Parties (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r cp133.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~cp13 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Meetings of Political Parties (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r cp13ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp13,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Political Parties (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r cp13ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp13,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Political Parties (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r cp13ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp13,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Political Parties (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r cp13ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp13,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Political Parties (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r cp13ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp13,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Political Parties (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r cp13ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp13,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Political Parties (row)
 & Basic Rights are Protected (col)")) 

```



```{r cp13ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp13,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Political Parties (row)
 & Receives Remittances (col)")) 

```



```{r cp13ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp13,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Political Parties (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Requested Help from a Member of the Legislature
__Interpretation Hint__: NA


Single choice question 


```{r cp2.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$cp2))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "cp2"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$cp2, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$cp2,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ cp2, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Requested Help from a Member of the Legislature",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r cp21.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~cp2 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Requested Help from a Member of the Legislature (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r cp22.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~cp2 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Requested Help from a Member of the Legislature (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r cp23.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~cp2 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Requested Help from a Member of the Legislature (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r cp2ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp2,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Requested Help from a Member of the Legislature (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r cp2ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp2,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Requested Help from a Member of the Legislature (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r cp2ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp2,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Requested Help from a Member of the Legislature (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r cp2ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp2,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Requested Help from a Member of the Legislature (row)
 & Basic Rights are Protected (col)")) 

```



```{r cp2ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp2,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Requested Help from a Member of the Legislature (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Attendance at Meetings of Women's Group
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Attendance at Meetings of Religious Organization
__Interpretation Hint__: NA


Single choice question 


```{r cp6.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=4, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$cp6))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "cp6" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "cp6"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$cp6, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$cp6,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ cp6, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "cp6" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Meetings of Religious Organization",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r cp61.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~cp6 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Meetings of Religious Organization (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r cp62.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~cp6 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Meetings of Religious Organization (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r cp63.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~cp6 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Meetings of Religious Organization (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r cp6ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp6,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Religious Organization (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r cp6ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp6,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Religious Organization (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r cp6ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp6,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Religious Organization (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r cp6ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp6,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Religious Organization (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r cp6ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp6,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Religious Organization (row)
 & Basic Rights are Protected (col)")) 

```



```{r cp6ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp6,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Religious Organization (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Attendance at Meetings of Parent Association
__Interpretation Hint__: NA


Single choice question 


```{r cp7.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=4, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$cp7))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "cp7" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "cp7"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$cp7, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$cp7,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ cp7, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "cp7" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Meetings of Parent Association",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r cp71.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~cp7 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Meetings of Parent Association (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r cp72.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~cp7 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Meetings of Parent Association (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r cp73.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~cp7 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Meetings of Parent Association (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r cp7ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp7,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Parent Association (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r cp7ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp7,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Parent Association (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r cp7ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp7,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Parent Association (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r cp7ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp7,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Parent Association (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r cp7ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp7,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Parent Association (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r cp7ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp7,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Parent Association (row)
 & Basic Rights are Protected (col)")) 

```



```{r cp7ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp7,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Parent Association (row)
 & Receives Remittances (col)")) 

```



```{r cp7ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp7,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings of Parent Association (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Attendance at Meetings for Community Improvements
__Interpretation Hint__: NA


Single choice question 


```{r cp8.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=4, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$cp8))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "cp8" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "cp8"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$cp8, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$cp8,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ cp8, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "cp8" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Meetings for Community Improvements",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r cp81.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~cp8 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Meetings for Community Improvements (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r cp82.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~cp8 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Meetings for Community Improvements (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r cp83.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~cp8 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Meetings for Community Improvements (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r cp8ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp8,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings for Community Improvements (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r cp8ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp8,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings for Community Improvements (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r cp8ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp8,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings for Community Improvements (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r cp8ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp8,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings for Community Improvements (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r cp8ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp8,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings for Community Improvements (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r cp8ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp8,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings for Community Improvements (row)
 & Basic Rights are Protected (col)")) 

```



```{r cp8ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp8,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings for Community Improvements (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r cp8ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp8,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings for Community Improvements (row)
 & Receives Remittances (col)")) 

```



```{r cp8ccc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$cp8,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Meetings for Community Improvements (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Participated in a Protest
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Identifies with a Political Party
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Voted in Last Presidential Election
__Interpretation Hint__: NA


Single choice question 


```{r vb2.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$vb2))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "vb2"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$vb2, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$vb2,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ vb2, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Voted in Last Presidential Election",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r vb21.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~vb2 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Voted in Last Presidential Election (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r vb22.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~vb2 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Voted in Last Presidential Election (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r vb23.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~vb2 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Voted in Last Presidential Election (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r vb2ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$vb2,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Voted in Last Presidential Election (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r vb2ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$vb2,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Voted in Last Presidential Election (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r vb2ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$vb2,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Voted in Last Presidential Election (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r vb2ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$vb2,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Voted in Last Presidential Election (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r vb2ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$vb2,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Voted in Last Presidential Election (row)
 & Basic Rights are Protected (col)")) 

```



```{r vb2ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$vb2,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Voted in Last Presidential Election (row)
 & Receives Remittances (col)")) 

```



```{r vb2ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$vb2,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Voted in Last Presidential Election (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Vote Intention for President
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.

#  Potential Protection Risk


 
## Likelihood of Death or Harm from Natural Disaster
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Asked to Pay Bribe to Process Document in Municipality
__Interpretation Hint__: NA


Single choice question 


```{r exc11.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$exc11))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "exc11"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$exc11, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$exc11,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ exc11, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay Bribe to Process Document in Municipality",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r exc111.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc11 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay Bribe to Process Document in Municipality (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r exc112.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc11 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay Bribe to Process Document in Municipality (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r exc113.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc11 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay Bribe to Process Document in Municipality (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r exc11ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc11,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay Bribe to Process Document in Municipality (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r exc11ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc11,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay Bribe to Process Document in Municipality (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r exc11ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc11,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay Bribe to Process Document in Municipality (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r exc11ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc11,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay Bribe to Process Document in Municipality (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r exc11ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc11,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay Bribe to Process Document in Municipality (row)
 & Basic Rights are Protected (col)")) 

```



```{r exc11ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc11,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay Bribe to Process Document in Municipality (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r exc11ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc11,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay Bribe to Process Document in Municipality (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Asked to Pay a Bribe to use Public Health Services
__Interpretation Hint__: NA


Single choice question 


```{r exc15.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$exc15))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "exc15"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$exc15, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$exc15,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ exc15, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay a Bribe to use Public Health Services",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r exc151.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc15 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay a Bribe to use Public Health Services (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r exc152.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc15 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay a Bribe to use Public Health Services (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r exc153.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc15 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay a Bribe to use Public Health Services (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r exc15ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc15,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe to use Public Health Services (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r exc15ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc15,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe to use Public Health Services (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r exc15ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc15,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe to use Public Health Services (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r exc15ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc15,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe to use Public Health Services (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r exc15ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc15,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe to use Public Health Services (row)
 & Basic Rights are Protected (col)")) 

```



```{r exc15ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc15,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe to use Public Health Services (row)
 & Receives Remittances (col)")) 

```



```{r exc15ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc15,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe to use Public Health Services (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Asked to Pay a Bribe at School
__Interpretation Hint__: NA


Single choice question 


```{r exc16.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$exc16))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "exc16"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$exc16, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$exc16,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ exc16, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay a Bribe at School",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r exc161.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc16 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay a Bribe at School (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r exc162.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc16 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay a Bribe at School (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r exc163.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc16 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay a Bribe at School (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r exc16ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc16,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe at School (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r exc16ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc16,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe at School (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r exc16ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc16,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe at School (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r exc16ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc16,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe at School (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r exc16ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc16,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe at School (row)
 & Basic Rights are Protected (col)")) 

```



```{r exc16ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc16,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe at School (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r exc16ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc16,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe at School (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Paying a Bribe is Justified
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Police Officer Asked for a Bribe
__Interpretation Hint__: NA


Single choice question 


```{r exc2.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$exc2))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "exc2"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$exc2, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$exc2,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ exc2, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Police Officer Asked for a Bribe",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r exc21.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc2 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Police Officer Asked for a Bribe (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r exc22.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc2 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Police Officer Asked for a Bribe (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r exc23.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc2 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Police Officer Asked for a Bribe (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r exc2ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc2,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Police Officer Asked for a Bribe (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r exc2ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc2,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Police Officer Asked for a Bribe (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r exc2ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc2,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Police Officer Asked for a Bribe (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r exc2ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc2,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Police Officer Asked for a Bribe (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r exc2ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc2,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Police Officer Asked for a Bribe (row)
 & Basic Rights are Protected (col)")) 

```



```{r exc2ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc2,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Police Officer Asked for a Bribe (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r exc2ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc2,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Police Officer Asked for a Bribe (row)
 & Receives Remittances (col)")) 

```



```{r exc2ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc2,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Police Officer Asked for a Bribe (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Soldier Requested a Bribe
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Government Employee Asked for a Bribe
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Victim of Crime
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Victim of Crime in the Last 12 Months (Frequency)
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Courts Guarantee Fair Trial
__Interpretation Hint__: NA


Single choice question 


```{r b1.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$b1))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "b1" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "b1"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$b1, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$b1,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ b1, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "b1" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Courts Guarantee Fair Trial",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r b11.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b1 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Courts Guarantee Fair Trial (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b12.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b1 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Courts Guarantee Fair Trial (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b13.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b1 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Courts Guarantee Fair Trial (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r b1ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b1,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Courts Guarantee Fair Trial (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r b1ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b1,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Courts Guarantee Fair Trial (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r b1ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b1,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Courts Guarantee Fair Trial (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r b1ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b1,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Courts Guarantee Fair Trial (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r b1ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b1,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Courts Guarantee Fair Trial (row)
 & Basic Rights are Protected (col)")) 

```



```{r b1ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b1,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Courts Guarantee Fair Trial (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r b1ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b1,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Courts Guarantee Fair Trial (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Basic Rights are Protected
__Interpretation Hint__: NA


Single choice question 


```{r b3.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$b3))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "b3" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "b3"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$b3, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$b3,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ b3, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "b3" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Basic Rights are Protected",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r b31.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b3 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Basic Rights are Protected (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b32.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b3 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Basic Rights are Protected (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b33.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b3 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Basic Rights are Protected (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r b3ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b3,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Basic Rights are Protected (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r b3ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b3,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Basic Rights are Protected (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r b3ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b3,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Basic Rights are Protected (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r b3ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b3,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Basic Rights are Protected (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r b3ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b3,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Basic Rights are Protected (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r b3ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b3,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Basic Rights are Protected (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r b3ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b3,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Basic Rights are Protected (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Level of Freedom of the Press Today
__Interpretation Hint__: NA


Single choice question 


```{r lib1.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$lib1))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "lib1"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$lib1, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$lib1,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ lib1, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Level of Freedom of the Press Today",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r lib11.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~lib1 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Level of Freedom of the Press Today (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r lib12.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~lib1 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Level of Freedom of the Press Today (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r lib13.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~lib1 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Level of Freedom of the Press Today (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r lib1ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$lib1,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Level of Freedom of the Press Today (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r lib1ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$lib1,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Level of Freedom of the Press Today (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r lib1ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$lib1,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Level of Freedom of the Press Today (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r lib1ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$lib1,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Level of Freedom of the Press Today (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r lib1ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$lib1,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Level of Freedom of the Press Today (row)
 & Basic Rights are Protected (col)")) 

```



```{r lib1ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$lib1,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Level of Freedom of the Press Today (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Level of Freedom to Express Political Opinions without Fear
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Religion
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.

#  Climate Change & Disaster Risk Reduction


 
## Spend More to Enforce Building Codes
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Higher Priority for Protecting Environment or Promoting Economic Growth
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Seriousness of Climate Change
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.

#  Corruption


 
## Asked to Pay a Bribe at Work
__Interpretation Hint__: NA


Single choice question 


```{r exc13.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$exc13))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "exc13"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$exc13, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$exc13,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ exc13, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay a Bribe at Work",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r exc131.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc13 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay a Bribe at Work (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r exc132.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc13 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay a Bribe at Work (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r exc133.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc13 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay a Bribe at Work (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r exc13ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc13,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe at Work (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r exc13ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc13,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe at Work (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r exc13ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc13,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe at Work (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r exc13ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc13,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe at Work (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r exc13ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc13,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe at Work (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r exc13ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc13,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe at Work (row)
 & Basic Rights are Protected (col)")) 

```



```{r exc13ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc13,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe at Work (row)
 & Receives Remittances (col)")) 

```



```{r exc13ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc13,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe at Work (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Asked to Pay a Bribe to the Courts
__Interpretation Hint__: NA


Single choice question 


```{r exc14.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$exc14))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "exc14"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$exc14, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$exc14,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ exc14, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay a Bribe to the Courts",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r exc141.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc14 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay a Bribe to the Courts (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r exc142.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc14 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay a Bribe to the Courts (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r exc143.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc14 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Asked to Pay a Bribe to the Courts (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r exc14ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc14,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe to the Courts (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r exc14ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc14,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe to the Courts (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r exc14ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc14,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe to the Courts (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r exc14ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc14,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Asked to Pay a Bribe to the Courts (row)
 & Police Officer Asked for a Bribe (col)")) 

```



 
## Perception of Public Corruption among Public Officials
__Interpretation Hint__: NA


Single choice question 


```{r exc7.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=4, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$exc7))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "exc7" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "exc7"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$exc7, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$exc7,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ exc7, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "exc7" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Perception of Public Corruption among Public Officials",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r exc71.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc7 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Perception of Public Corruption among Public Officials (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r exc72.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc7 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Perception of Public Corruption among Public Officials (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r exc73.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~exc7 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Perception of Public Corruption among Public Officials (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r exc7ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc7,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Perception of Public Corruption among Public Officials (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r exc7ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc7,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Perception of Public Corruption among Public Officials (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r exc7ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc7,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Perception of Public Corruption among Public Officials (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r exc7ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc7,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Perception of Public Corruption among Public Officials (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r exc7ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc7,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Perception of Public Corruption among Public Officials (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r exc7ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc7,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Perception of Public Corruption among Public Officials (row)
 & Basic Rights are Protected (col)")) 

```



```{r exc7ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc7,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Perception of Public Corruption among Public Officials (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r exc7ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$exc7,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Perception of Public Corruption among Public Officials (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Amount of Corruption among Politicians
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.

#  Crime, Insecurity, and Policy Preferences


 
## Perception of Neighborhood Insecurity
__Interpretation Hint__: NA


Single choice question 


```{r aoj11.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=4, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$aoj11))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "aoj11" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "aoj11"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$aoj11, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$aoj11,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ aoj11, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "aoj11" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Perception of Neighborhood Insecurity",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r aoj111.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~aoj11 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Perception of Neighborhood Insecurity (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r aoj112.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~aoj11 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Perception of Neighborhood Insecurity (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r aoj113.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~aoj11 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Perception of Neighborhood Insecurity (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r aoj11ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$aoj11,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Perception of Neighborhood Insecurity (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r aoj11ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$aoj11,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Perception of Neighborhood Insecurity (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r aoj11ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$aoj11,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Perception of Neighborhood Insecurity (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r aoj11ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$aoj11,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Perception of Neighborhood Insecurity (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r aoj11ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$aoj11,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Perception of Neighborhood Insecurity (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r aoj11ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$aoj11,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Perception of Neighborhood Insecurity (row)
 & Basic Rights are Protected (col)")) 

```



```{r aoj11ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$aoj11,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Perception of Neighborhood Insecurity (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r aoj11ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$aoj11,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Perception of Neighborhood Insecurity (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Confidence that Judiciary will Punish the Guilty
__Interpretation Hint__: NA


Single choice question 


```{r aoj12.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=4, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$aoj12))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "aoj12" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "aoj12"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$aoj12, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$aoj12,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ aoj12, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "aoj12" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Confidence that Judiciary will Punish the Guilty",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r aoj121.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~aoj12 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Confidence that Judiciary will Punish the Guilty (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r aoj122.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~aoj12 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Confidence that Judiciary will Punish the Guilty (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r aoj123.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~aoj12 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Confidence that Judiciary will Punish the Guilty (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r aoj12ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$aoj12,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Confidence that Judiciary will Punish the Guilty (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r aoj12ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$aoj12,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Confidence that Judiciary will Punish the Guilty (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r aoj12ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$aoj12,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Confidence that Judiciary will Punish the Guilty (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r aoj12ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$aoj12,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Confidence that Judiciary will Punish the Guilty (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r aoj12ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$aoj12,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Confidence that Judiciary will Punish the Guilty (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r aoj12ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$aoj12,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Confidence that Judiciary will Punish the Guilty (row)
 & Basic Rights are Protected (col)")) 

```



```{r aoj12ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$aoj12,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Confidence that Judiciary will Punish the Guilty (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r aoj12ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$aoj12,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Confidence that Judiciary will Punish the Guilty (row)
 & Intends to Live or Work Abroad (col)")) 

```


#  Evaluation of Institutions, Political System and Other Persons


 
## Most Important Problem
__Interpretation Hint__: NA


Single choice question 


```{r a4.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=4, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$a4))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "a4"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$a4, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$a4,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ a4, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Most Important Problem",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r a41.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~a4 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Most Important Problem (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r a42.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~a4 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Most Important Problem (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r a43.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~a4 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Most Important Problem (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r a4ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$a4,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Most Important Problem (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r a4ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$a4,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Most Important Problem (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r a4ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$a4,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Most Important Problem (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r a4ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$a4,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Most Important Problem (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r a4ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$a4,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Most Important Problem (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r a4ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$a4,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Most Important Problem (row)
 & Basic Rights are Protected (col)")) 

```



```{r a4ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$a4,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Most Important Problem (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r a4ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$a4,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Most Important Problem (row)
 & Receives Remittances (col)")) 

```



```{r a4ccc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$a4,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Most Important Problem (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Trust in Armed Forces
__Interpretation Hint__: NA


Single choice question 


```{r b12.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$b12))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "b12" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "b12"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$b12, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$b12,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ b12, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "b12" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Trust in Armed Forces",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r b121.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b12 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in Armed Forces (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b122.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b12 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in Armed Forces (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b123.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b12 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in Armed Forces (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r b12ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b12,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Armed Forces (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r b12ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b12,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Armed Forces (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r b12ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b12,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Armed Forces (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r b12ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b12,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Armed Forces (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r b12ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b12,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Armed Forces (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r b12ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b12,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Armed Forces (row)
 & Basic Rights are Protected (col)")) 

```



```{r b12ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b12,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Armed Forces (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r b12ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b12,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Armed Forces (row)
 & Receives Remittances (col)")) 

```



```{r b12ccc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b12,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Armed Forces (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Trust in the National Legislature
__Interpretation Hint__: NA


Single choice question 


```{r b13.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$b13))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "b13" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "b13"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$b13, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$b13,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ b13, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "b13" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Trust in the National Legislature",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r b131.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b13 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in the National Legislature (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b132.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b13 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in the National Legislature (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b133.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b13 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in the National Legislature (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r b13ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b13,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the National Legislature (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r b13ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b13,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the National Legislature (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r b13ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b13,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the National Legislature (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r b13ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b13,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the National Legislature (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r b13ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b13,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the National Legislature (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r b13ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b13,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the National Legislature (row)
 & Basic Rights are Protected (col)")) 

```



```{r b13ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b13,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the National Legislature (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r b13ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b13,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the National Legislature (row)
 & Receives Remittances (col)")) 

```



```{r b13ccc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b13,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the National Legislature (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Trust in National Police
__Interpretation Hint__: NA


Single choice question 


```{r b18.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$b18))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "b18" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "b18"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$b18, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$b18,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ b18, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "b18" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Trust in National Police",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r b181.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b18 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in National Police (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b182.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b18 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in National Police (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b183.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b18 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in National Police (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r b18ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b18,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in National Police (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r b18ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b18,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in National Police (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r b18ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b18,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in National Police (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r b18ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b18,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in National Police (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r b18ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b18,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in National Police (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r b18ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b18,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in National Police (row)
 & Basic Rights are Protected (col)")) 

```



```{r b18ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b18,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in National Police (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r b18ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b18,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in National Police (row)
 & Receives Remittances (col)")) 

```



```{r b18ccc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b18,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in National Police (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Respect for Political Institutions
__Interpretation Hint__: NA


Single choice question 


```{r b2.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$b2))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "b2" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "b2"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$b2, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$b2,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ b2, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "b2" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Respect for Political Institutions",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r b21.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b2 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Respect for Political Institutions (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b22.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b2 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Respect for Political Institutions (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b23.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b2 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Respect for Political Institutions (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r b2ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b2,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Respect for Political Institutions (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r b2ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b2,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Respect for Political Institutions (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r b2ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b2,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Respect for Political Institutions (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r b2ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b2,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Respect for Political Institutions (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r b2ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b2,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Respect for Political Institutions (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r b2ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b2,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Respect for Political Institutions (row)
 & Basic Rights are Protected (col)")) 

```



```{r b2ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b2,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Respect for Political Institutions (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r b2ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b2,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Respect for Political Institutions (row)
 & Receives Remittances (col)")) 

```



```{r b2ccc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b2,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Respect for Political Institutions (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Trust in Catholic Church
__Interpretation Hint__: NA


Single choice question 


```{r b20.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$b20))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "b20"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$b20, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$b20,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ b20, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Trust in Catholic Church",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r b201.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b20 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in Catholic Church (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b202.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b20 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in Catholic Church (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b203.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b20 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in Catholic Church (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r b20ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b20,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Catholic Church (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r b20ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b20,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Catholic Church (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r b20ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b20,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Catholic Church (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r b20ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b20,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Catholic Church (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r b20ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b20,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Catholic Church (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r b20ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b20,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Catholic Church (row)
 & Basic Rights are Protected (col)")) 

```



```{r b20ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b20,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Catholic Church (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r b20ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b20,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Catholic Church (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Trust in Evangelical/Protestant Church
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Trust in Political Parties
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Trust in Executive
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Trust in the Supreme Court of Justice
__Interpretation Hint__: NA


Single choice question 


```{r b31.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$b31))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "b31"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$b31, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$b31,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ b31, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Trust in the Supreme Court of Justice",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r b311.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b31 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in the Supreme Court of Justice (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b312.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b31 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in the Supreme Court of Justice (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b313.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b31 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in the Supreme Court of Justice (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r b31ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b31,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the Supreme Court of Justice (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r b31ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b31,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the Supreme Court of Justice (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r b31ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b31,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the Supreme Court of Justice (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r b31ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b31,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the Supreme Court of Justice (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r b31ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b31,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the Supreme Court of Justice (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r b31ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b31,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the Supreme Court of Justice (row)
 & Basic Rights are Protected (col)")) 

```



```{r b31ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b31,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the Supreme Court of Justice (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r b31ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b31,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the Supreme Court of Justice (row)
 & Receives Remittances (col)")) 

```



```{r b31ccc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b31,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the Supreme Court of Justice (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Trust in Local Government
__Interpretation Hint__: NA


Single choice question 


```{r b32.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$b32))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "b32" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "b32"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$b32, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$b32,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ b32, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "b32" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Trust in Local Government",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r b321.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b32 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in Local Government (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b322.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b32 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in Local Government (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b323.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b32 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in Local Government (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r b32ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b32,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Local Government (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r b32ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b32,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Local Government (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r b32ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b32,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Local Government (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r b32ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b32,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Local Government (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r b32ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b32,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Local Government (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r b32ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b32,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Local Government (row)
 & Basic Rights are Protected (col)")) 

```



```{r b32ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b32,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Local Government (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r b32ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b32,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Local Government (row)
 & Receives Remittances (col)")) 

```



```{r b32ccc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b32,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in Local Government (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Trust in the Media
__Interpretation Hint__: NA


Single choice question 


```{r b37.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$b37))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "b37" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "b37"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$b37, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$b37,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ b37, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "b37" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Trust in the Media",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r b371.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b37 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in the Media (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b372.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b37 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in the Media (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b373.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b37 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Trust in the Media (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r b37ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b37,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the Media (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r b37ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b37,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the Media (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r b37ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b37,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the Media (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r b37ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b37,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the Media (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r b37ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b37,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the Media (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r b37ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b37,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the Media (row)
 & Basic Rights are Protected (col)")) 

```



```{r b37ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b37,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the Media (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r b37ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b37,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the Media (row)
 & Receives Remittances (col)")) 

```



```{r b37ccc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b37,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Trust in the Media (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Pride in Political System
__Interpretation Hint__: NA


Single choice question 


```{r b4.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$b4))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "b4" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "b4"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$b4, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$b4,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ b4, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "b4" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Pride in Political System",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r b41.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b4 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Pride in Political System (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b42.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b4 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Pride in Political System (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b43.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b4 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Pride in Political System (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r b4ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b4,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Pride in Political System (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r b4ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b4,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Pride in Political System (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r b4ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b4,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Pride in Political System (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r b4ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b4,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Pride in Political System (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r b4ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b4,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Pride in Political System (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r b4ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b4,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Pride in Political System (row)
 & Basic Rights are Protected (col)")) 

```



```{r b4ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b4,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Pride in Political System (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r b4ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b4,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Pride in Political System (row)
 & Receives Remittances (col)")) 

```



```{r b4ccc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b4,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Pride in Political System (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Trust in Elections
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## People Should Support the Political System
__Interpretation Hint__: NA


Single choice question 


```{r b6.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$b6))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "b6" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "b6"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$b6, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$b6,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ b6, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "b6" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "People Should Support the Political System",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r b61.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b6 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "People Should Support the Political System (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b62.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b6 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "People Should Support the Political System (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r b63.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~b6 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "People Should Support the Political System (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r b6ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b6,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
People Should Support the Political System (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r b6ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b6,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
People Should Support the Political System (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r b6ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b6,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
People Should Support the Political System (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r b6ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b6,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
People Should Support the Political System (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r b6ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b6,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
People Should Support the Political System (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r b6ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b6,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
People Should Support the Political System (row)
 & Basic Rights are Protected (col)")) 

```



```{r b6ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b6,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
People Should Support the Political System (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r b6ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b6,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
People Should Support the Political System (row)
 & Receives Remittances (col)")) 

```



```{r b6ccc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$b6,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
People Should Support the Political System (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Leaders Are Interested in What People Think
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Understands Important Political Issues
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Interpersonal Trust
__Interpretation Hint__: NA


Single choice question 


```{r it1.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=4, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$it1))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "it1" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "it1"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$it1, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$it1,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ it1, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "it1" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Interpersonal Trust",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r it11.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~it1 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Interpersonal Trust (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r it12.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~it1 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Interpersonal Trust (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r it13.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~it1 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Interpersonal Trust (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r it1ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$it1,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Interpersonal Trust (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r it1ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$it1,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Interpersonal Trust (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r it1ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$it1,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Interpersonal Trust (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r it1ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$it1,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Interpersonal Trust (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r it1ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$it1,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Interpersonal Trust (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r it1ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$it1,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Interpersonal Trust (row)
 & Basic Rights are Protected (col)")) 

```



```{r it1ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$it1,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Interpersonal Trust (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r it1ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$it1,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Interpersonal Trust (row)
 & Receives Remittances (col)")) 

```



```{r it1ccc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$it1,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Interpersonal Trust (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Executive Job Approval
__Interpretation Hint__: NA


Single choice question 


```{r m1.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=4, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$m1))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "m1"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$m1, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$m1,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ m1, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Executive Job Approval",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r m11.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~m1 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Executive Job Approval (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r m12.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~m1 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Executive Job Approval (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r m13.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~m1 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Executive Job Approval (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r m1ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$m1,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Executive Job Approval (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r m1ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$m1,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Executive Job Approval (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r m1ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$m1,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Executive Job Approval (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r m1ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$m1,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Executive Job Approval (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r m1ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$m1,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Executive Job Approval (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r m1ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$m1,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Executive Job Approval (row)
 & Basic Rights are Protected (col)")) 

```



```{r m1ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$m1,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Executive Job Approval (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r m1ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$m1,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Executive Job Approval (row)
 & Receives Remittances (col)")) 

```



```{r m1ccc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$m1,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Executive Job Approval (row)
 & Intends to Live or Work Abroad (col)")) 

```


#  Foreign Relations


 
## Trustworthiness of Chinese Government
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Trustworthiness of US Government
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.

#  Gender


 
## Children Suffer with Working Mothers
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Men Are Better Political Leaders than Women
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Men or Women: More Corrupt as Politicians
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Men or Women: Better Manager of Economy
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Abortion Justified
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.

#  Local Government


 
## Police Response Time
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Attendance at Municipal Meeting
__Interpretation Hint__: NA


Single choice question 


```{r np1.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$np1))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "np1" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "np1"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$np1, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$np1,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ np1, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "np1" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Municipal Meeting",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r np11.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~np1 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Municipal Meeting (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r np12.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~np1 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Municipal Meeting (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r np13.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~np1 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Attendance at Municipal Meeting (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r np1ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$np1,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Municipal Meeting (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r np1ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$np1,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Municipal Meeting (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r np1ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$np1,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Municipal Meeting (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r np1ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$np1,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Municipal Meeting (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r np1ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$np1,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Municipal Meeting (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r np1ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$np1,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Municipal Meeting (row)
 & Basic Rights are Protected (col)")) 

```



```{r np1ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$np1,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Municipal Meeting (row)
 & Receives Remittances (col)")) 

```



```{r np1ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$np1,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Attendance at Municipal Meeting (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Satisfaction with Roads
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Satisfaction with Public Schools
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Satisfaction with Public Medical and Health Services
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.

#  Migration


 
## Receives Remittances
__Interpretation Hint__: NA


Single choice question 


```{r q10a.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$q10a))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "q10a"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$q10a, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$q10a,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ q10a, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Receives Remittances",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r q10a1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~q10a + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Receives Remittances (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r q10a2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~q10a + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Receives Remittances (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r q10a3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~q10a + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Receives Remittances (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r q10accc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$q10a,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Receives Remittances (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r q10accc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$q10a,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Receives Remittances (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r q10accc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$q10a,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Receives Remittances (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Intends to Live or Work Abroad
__Interpretation Hint__: NA


Single choice question 


```{r q14.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$q14))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "q14"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$q14, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$q14,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ q14, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Intends to Live or Work Abroad",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r q141.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~q14 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Intends to Live or Work Abroad (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r q142.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~q14 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Intends to Live or Work Abroad (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r q143.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~q14 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Intends to Live or Work Abroad (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r q14ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$q14,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Intends to Live or Work Abroad (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r q14ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$q14,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Intends to Live or Work Abroad (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r q14ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$q14,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Intends to Live or Work Abroad (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r q14ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$q14,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Intends to Live or Work Abroad (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r q14ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$q14,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Intends to Live or Work Abroad (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r q14ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$q14,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Intends to Live or Work Abroad (row)
 & Basic Rights are Protected (col)")) 

```



```{r q14ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$q14,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Intends to Live or Work Abroad (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r q14ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$q14,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Intends to Live or Work Abroad (row)
 & Receives Remittances (col)")) 

```


#  Political and Religious Orientation


 
## Ideology (Left / Right)
__Interpretation Hint__: NA


Single choice question 


```{r l1.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=9, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$l1))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "l1"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$l1, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$l1,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ l1, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Ideology (Left / Right)",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r l11.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~l1 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Ideology (Left / Right) (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r l12.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~l1 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Ideology (Left / Right) (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r l13.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~l1 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Ideology (Left / Right) (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)


No significant association found for this question...


 
## Ideología (liberal / conservador)
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Attendance at Religious Services
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Importance of Religion
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.

#  Political Tolerance


 
## Approval of Government Critics' Right to Vote
__Interpretation Hint__: NA


Single choice question 


```{r d1.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=9, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$d1))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "d1" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "d1"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$d1, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$d1,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ d1, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "d1" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Approval of Government Critics' Right to Vote",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r d11.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~d1 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Approval of Government Critics' Right to Vote (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r d12.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~d1 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Approval of Government Critics' Right to Vote (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r d13.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~d1 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Approval of Government Critics' Right to Vote (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)


No significant association found for this question...


 
## Approval of Government Critics' Right to Protest
__Interpretation Hint__: NA


Single choice question 


```{r d2.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=9, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$d2))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "d2" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "d2"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$d2, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$d2,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ d2, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "d2" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Approval of Government Critics' Right to Protest",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r d21.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~d2 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Approval of Government Critics' Right to Protest (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r d22.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~d2 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Approval of Government Critics' Right to Protest (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r d23.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~d2 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Approval of Government Critics' Right to Protest (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)


No significant association found for this question...


 
## Approval of Government Critics' Right to Run for Office
__Interpretation Hint__: NA


Single choice question 


```{r d3.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=9, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$d3))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "d3" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "d3"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$d3, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$d3,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ d3, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "d3" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Approval of Government Critics' Right to Run for Office",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r d31.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~d3 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Approval of Government Critics' Right to Run for Office (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r d32.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~d3 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Approval of Government Critics' Right to Run for Office (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r d33.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~d3 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Approval of Government Critics' Right to Run for Office (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)


No significant association found for this question...


 
## Approval of Government Critics' Right to Make Speeches
__Interpretation Hint__: NA


Single choice question 


```{r d4.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=9, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$d4))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "d4" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "d4"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$d4, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$d4,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ d4, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "d4" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Approval of Government Critics' Right to Make Speeches",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r d41.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~d4 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Approval of Government Critics' Right to Make Speeches (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r d42.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~d4 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Approval of Government Critics' Right to Make Speeches (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r d43.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~d4 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Approval of Government Critics' Right to Make Speeches (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)


No significant association found for this question...


 
## Approval of Homosexuals' Right to Run for Office
__Interpretation Hint__: NA


Single choice question 


```{r d5.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=9, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$d5))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "d5" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "d5"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$d5, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$d5,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ d5, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "d5" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Approval of Homosexuals' Right to Run for Office",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r d51.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~d5 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Approval of Homosexuals' Right to Run for Office (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r d52.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~d5 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Approval of Homosexuals' Right to Run for Office (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r d53.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~d5 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Approval of Homosexuals' Right to Run for Office (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)


No significant association found for this question...


 
## Approval of Same-Sex Couples' Right to Marry
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Approval of Those Participating in Legal Demonstration
__Interpretation Hint__: NA


Single choice question 


```{r e5.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=9, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$e5))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "e5" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "e5"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$e5, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$e5,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ e5, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "e5" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Approval of Those Participating in Legal Demonstration",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r e51.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~e5 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Approval of Those Participating in Legal Demonstration (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r e52.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~e5 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Approval of Those Participating in Legal Demonstration (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r e53.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~e5 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Approval of Those Participating in Legal Demonstration (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)


No significant association found for this question...

#  Political & Electoral Engagement


 
## Knows Someone Offered Benefit for Vote (Last National Election)
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Offered Benefit for Vote (Last General Election)
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Frequency of Paying Attention to the News
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Frequency of Watching News
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Political Interest
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.

#  Socio-Demographic Characteristics


 
## Urban/Rural
__Interpretation Hint__: NA


Single choice question 


```{r ur.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$ur))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "ur"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$ur, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$ur,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ ur, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Urban/Rural",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r ur1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~ur + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Urban/Rural (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r ur2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~ur + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Urban/Rural (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r ur3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~ur + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Urban/Rural (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r urccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ur,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Urban/Rural (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r urccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ur,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Urban/Rural (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r urccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ur,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Urban/Rural (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r urccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ur,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Urban/Rural (row)
 & Basic Rights are Protected (col)")) 

```



```{r urccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ur,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Urban/Rural (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r urccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ur,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Urban/Rural (row)
 & Receives Remittances (col)")) 

```



```{r urccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ur,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Urban/Rural (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Beneficiary of Conditional Cash Transfer Program
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Years of Schooling
__Interpretation Hint__: NA


Single choice question 


```{r ed.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=10, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$ed))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "ed"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$ed, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$ed,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ ed, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Years of Schooling",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r ed1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~ed + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Years of Schooling (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r ed2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~ed + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Years of Schooling (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r ed3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~ed + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Years of Schooling (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)


No significant association found for this question...


 
## Ethnicity
__Interpretation Hint__: NA


Single choice question 


```{r etid.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=5, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$etid))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "etid"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$etid, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$etid,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ etid, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Ethnicity",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r etid1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~etid + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Ethnicity (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r etid2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~etid + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Ethnicity (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r etid3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~etid + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Ethnicity (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r etidccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$etid,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Ethnicity (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r etidccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$etid,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Ethnicity (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r etidccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$etid,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Ethnicity (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r etidccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$etid,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Ethnicity (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r etidccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$etid,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Ethnicity (row)
 & Basic Rights are Protected (col)")) 

```



```{r etidccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$etid,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Ethnicity (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r etidccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$etid,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Ethnicity (row)
 & Receives Remittances (col)")) 

```



```{r etidccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$etid,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Ethnicity (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Mother Tongue
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Occupation
__Interpretation Hint__: NA


Single choice question 


```{r ocup1a.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=4, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$ocup1a))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "ocup1a"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$ocup1a, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$ocup1a,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ ocup1a, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Occupation",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r ocup1a1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~ocup1a + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Occupation (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r ocup1a2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~ocup1a + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Occupation (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r ocup1a3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~ocup1a + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Occupation (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r ocup1accc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ocup1a,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Occupation (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r ocup1accc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ocup1a,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Occupation (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r ocup1accc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ocup1a,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Occupation (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r ocup1accc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ocup1a,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Occupation (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r ocup1accc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ocup1a,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Occupation (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r ocup1accc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ocup1a,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Occupation (row)
 & Basic Rights are Protected (col)")) 

```



```{r ocup1accc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ocup1a,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Occupation (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r ocup1accc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ocup1a,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Occupation (row)
 & Receives Remittances (col)")) 

```



```{r ocup1accc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ocup1a,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Occupation (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Employment Status
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Sex
__Interpretation Hint__: NA


Single choice question 


```{r q1.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$q1))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "q1"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$q1, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$q1,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ q1, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Sex",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations





```{r q12.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~q1 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Sex (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r q13.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~q1 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Sex (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r q1ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$q1,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Sex (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r q1ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$q1,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Sex (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r q1ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$q1,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Sex (row)
 & Basic Rights are Protected (col)")) 

```



```{r q1ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$q1,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Sex (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r q1ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$q1,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Sex (row)
 & Receives Remittances (col)")) 

```



```{r q1ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$q1,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Sex (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Monthly Household Income
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Marital Status
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Number of Children
__Interpretation Hint__: NA


Single choice question 


```{r q12.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=10, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$q12))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "q12"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$q12, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$q12,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ q12, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Number of Children",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r q121.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~q12 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Number of Children (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r q122.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~q12 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Number of Children (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r q123.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~q12 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Number of Children (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)


No significant association found for this question...


 
## Number of Children under 13 in Household
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Number of People in Household
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
 
## Television in Home
__Interpretation Hint__: NA


Single choice question 


```{r r1.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$r1))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "r1"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$r1, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$r1,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ r1, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Television in Home",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r r11.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r1 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Television in Home (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r12.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r1 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Television in Home (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r13.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r1 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Television in Home (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r r1ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r1,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Television in Home (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r r1ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r1,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Television in Home (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r r1ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r1,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Television in Home (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r r1ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r1,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Television in Home (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r r1ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r1,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Television in Home (row)
 & Basic Rights are Protected (col)")) 

```



```{r r1ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r1,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Television in Home (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r r1ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r1,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Television in Home (row)
 & Receives Remittances (col)")) 

```



```{r r1ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r1,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Television in Home (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Drinking water in Home
__Interpretation Hint__: NA


Single choice question 


```{r r12.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$r12))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "r12"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$r12, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$r12,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ r12, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Drinking water in Home",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r r121.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r12 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Drinking water in Home (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r122.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r12 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Drinking water in Home (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r123.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r12 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Drinking water in Home (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r r12ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r12,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Drinking water in Home (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r r12ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r12,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Drinking water in Home (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r r12ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r12,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Drinking water in Home (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r r12ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r12,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Drinking water in Home (row)
 & Basic Rights are Protected (col)")) 

```



```{r r12ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r12,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Drinking water in Home (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r r12ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r12,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Drinking water in Home (row)
 & Receives Remittances (col)")) 

```



```{r r12ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r12,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Drinking water in Home (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Indoor Bathroom in Home
__Interpretation Hint__: NA


Single choice question 


```{r r14.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$r14))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "r14"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$r14, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$r14,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ r14, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Indoor Bathroom in Home",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r r141.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r14 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Indoor Bathroom in Home (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r142.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r14 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Indoor Bathroom in Home (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r143.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r14 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Indoor Bathroom in Home (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r r14ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r14,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Indoor Bathroom in Home (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r r14ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r14,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Indoor Bathroom in Home (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r r14ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r14,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Indoor Bathroom in Home (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r r14ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r14,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Indoor Bathroom in Home (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r r14ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r14,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Indoor Bathroom in Home (row)
 & Basic Rights are Protected (col)")) 

```



```{r r14ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r14,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Indoor Bathroom in Home (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r r14ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r14,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Indoor Bathroom in Home (row)
 & Receives Remittances (col)")) 

```



```{r r14ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r14,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Indoor Bathroom in Home (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Computer in Home
__Interpretation Hint__: NA


Single choice question 


```{r r15.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$r15))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "r15"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$r15, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$r15,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ r15, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Computer in Home",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r r151.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r15 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Computer in Home (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r152.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r15 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Computer in Home (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r153.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r15 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Computer in Home (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r r15ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r15,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Computer in Home (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r r15ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r15,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Computer in Home (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r r15ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r15,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Computer in Home (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r r15ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r15,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Computer in Home (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r r15ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r15,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Computer in Home (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r r15ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r15,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Computer in Home (row)
 & Basic Rights are Protected (col)")) 

```



```{r r15ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r15,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Computer in Home (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r r15ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r15,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Computer in Home (row)
 & Receives Remittances (col)")) 

```



```{r r15ccc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r15,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Computer in Home (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Flat Panel TV in Home
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Internet Service in Home
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Refrigerator in Home
__Interpretation Hint__: NA


Single choice question 


```{r r3.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$r3))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "r3"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$r3, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$r3,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ r3, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Refrigerator in Home",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r r31.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r3 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Refrigerator in Home (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r32.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r3 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Refrigerator in Home (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r33.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r3 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Refrigerator in Home (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r r3ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r3,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Refrigerator in Home (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r r3ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r3,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Refrigerator in Home (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r r3ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r3,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Refrigerator in Home (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r r3ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r3,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Refrigerator in Home (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r r3ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r3,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Refrigerator in Home (row)
 & Basic Rights are Protected (col)")) 

```



```{r r3ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r3,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Refrigerator in Home (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r r3ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r3,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Refrigerator in Home (row)
 & Receives Remittances (col)")) 

```



```{r r3ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r3,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Refrigerator in Home (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Landline in Home
__Interpretation Hint__: NA


Single choice question 


```{r r4.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$r4))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "r4"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$r4, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$r4,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ r4, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Landline in Home",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r r41.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r4 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Landline in Home (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r42.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r4 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Landline in Home (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r43.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r4 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Landline in Home (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r r4ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r4,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Landline in Home (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r r4ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r4,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Landline in Home (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r r4ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r4,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Landline in Home (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r r4ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r4,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Landline in Home (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r r4ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r4,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Landline in Home (row)
 & Basic Rights are Protected (col)")) 

```



```{r r4ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r4,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Landline in Home (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r r4ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r4,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Landline in Home (row)
 & Receives Remittances (col)")) 

```



```{r r4ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r4,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Landline in Home (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Cellular Telephone in Home
__Interpretation Hint__: NA


Single choice question 


```{r r4a.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$r4a))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "r4a"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$r4a, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$r4a,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ r4a, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Cellular Telephone in Home",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r r4a1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r4a + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Cellular Telephone in Home (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r4a2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r4a + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Cellular Telephone in Home (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r4a3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r4a + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Cellular Telephone in Home (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r r4accc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r4a,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Cellular Telephone in Home (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r r4accc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r4a,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Cellular Telephone in Home (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r r4accc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r4a,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Cellular Telephone in Home (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r r4accc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r4a,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Cellular Telephone in Home (row)
 & Basic Rights are Protected (col)")) 

```



```{r r4accc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r4a,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Cellular Telephone in Home (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r r4accc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r4a,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Cellular Telephone in Home (row)
 & Receives Remittances (col)")) 

```



```{r r4accc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r4a,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Cellular Telephone in Home (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Number of Vehicles at the House
__Interpretation Hint__: NA


Single choice question 


```{r r5.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=4, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$r5))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "r5"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$r5, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$r5,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ r5, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Number of Vehicles at the House",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r r51.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r5 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Number of Vehicles at the House (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r52.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r5 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Number of Vehicles at the House (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r53.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r5 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Number of Vehicles at the House (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r r5ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r5,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Number of Vehicles at the House (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r r5ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r5,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Number of Vehicles at the House (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r r5ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r5,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Number of Vehicles at the House (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r r5ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r5,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Number of Vehicles at the House (row)
 & Basic Rights are Protected (col)")) 

```



```{r r5ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r5,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Number of Vehicles at the House (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r r5ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r5,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Number of Vehicles at the House (row)
 & Receives Remittances (col)")) 

```



```{r r5ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r5,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Number of Vehicles at the House (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Washing Machine in Home
__Interpretation Hint__: NA


Single choice question 


```{r r6.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$r6))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "r6"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$r6, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$r6,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ r6, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Washing Machine in Home",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r r61.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r6 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Washing Machine in Home (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r62.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r6 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Washing Machine in Home (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r63.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r6 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Washing Machine in Home (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r r6ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r6,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Washing Machine in Home (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r r6ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r6,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Washing Machine in Home (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r r6ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r6,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Washing Machine in Home (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r r6ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r6,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Washing Machine in Home (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r r6ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r6,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Washing Machine in Home (row)
 & Basic Rights are Protected (col)")) 

```



```{r r6ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r6,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Washing Machine in Home (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r r6ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r6,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Washing Machine in Home (row)
 & Receives Remittances (col)")) 

```



```{r r6ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r6,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Washing Machine in Home (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Microwave Oven in Home
__Interpretation Hint__: NA


Single choice question 


```{r r7.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$r7))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "r7"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$r7, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$r7,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ r7, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Microwave Oven in Home",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r r71.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r7 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Microwave Oven in Home (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r72.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r7 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Microwave Oven in Home (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r r73.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~r7 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Microwave Oven in Home (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r r7ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r7,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Microwave Oven in Home (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r r7ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r7,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Microwave Oven in Home (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r r7ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r7,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Microwave Oven in Home (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r r7ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r7,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Microwave Oven in Home (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r r7ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r7,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Microwave Oven in Home (row)
 & Basic Rights are Protected (col)")) 

```



```{r r7ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r7,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Microwave Oven in Home (row)
 & Receives Remittances (col)")) 

```



```{r r7ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$r7,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Microwave Oven in Home (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Owns Motorcycle
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Country
__Interpretation Hint__: NA


Single choice question 


```{r pais.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$pais))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "pais"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$pais, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$pais,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ pais, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Country",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r pais1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~pais + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Country (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```






```{r pais3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~pais + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Country (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r paisccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$pais,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Country (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r paisccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$pais,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Country (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r paisccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$pais,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Country (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r paisccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$pais,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Country (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r paisccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$pais,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Country (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r paisccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$pais,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Country (row)
 & Basic Rights are Protected (col)")) 

```



```{r paisccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$pais,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Country (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r paisccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$pais,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Country (row)
 & Receives Remittances (col)")) 

```



```{r paisccc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$pais,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Country (row)
 & Intends to Live or Work Abroad (col)")) 

```






#  Support for Democracy and Democratic Institutions


 
## Democracy is Better than Any Other Form of Government
__Interpretation Hint__: NA


Single choice question 


```{r ing4.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$ing4))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "ing4"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$ing4, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$ing4,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ ing4, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Democracy is Better than Any Other Form of Government",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r ing41.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~ing4 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Democracy is Better than Any Other Form of Government (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r ing42.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~ing4 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Democracy is Better than Any Other Form of Government (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r ing43.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~ing4 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Democracy is Better than Any Other Form of Government (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r ing4ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ing4,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Democracy is Better than Any Other Form of Government (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r ing4ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ing4,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Democracy is Better than Any Other Form of Government (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r ing4ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ing4,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Democracy is Better than Any Other Form of Government (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r ing4ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ing4,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Democracy is Better than Any Other Form of Government (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r ing4ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ing4,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Democracy is Better than Any Other Form of Government (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r ing4ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ing4,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Democracy is Better than Any Other Form of Government (row)
 & Basic Rights are Protected (col)")) 

```



```{r ing4ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ing4,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Democracy is Better than Any Other Form of Government (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r ing4ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ing4,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Democracy is Better than Any Other Form of Government (row)
 & Receives Remittances (col)")) 

```



```{r ing4ccc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$ing4,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Democracy is Better than Any Other Form of Government (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Coup is Justified when Crime is High
__Interpretation Hint__: NA


Single choice question 


```{r jc10.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$jc10))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "jc10"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$jc10, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$jc10,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ jc10, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Coup is Justified when Crime is High",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r jc101.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~jc10 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Coup is Justified when Crime is High (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r jc102.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~jc10 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Coup is Justified when Crime is High (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r jc103.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~jc10 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Coup is Justified when Crime is High (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r jc10ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$jc10,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Coup is Justified when Crime is High (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r jc10ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$jc10,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Coup is Justified when Crime is High (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r jc10ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$jc10,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Coup is Justified when Crime is High (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r jc10ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$jc10,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Coup is Justified when Crime is High (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r jc10ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$jc10,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Coup is Justified when Crime is High (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r jc10ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$jc10,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Coup is Justified when Crime is High (row)
 & Basic Rights are Protected (col)")) 

```



```{r jc10ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$jc10,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Coup is Justified when Crime is High (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r jc10ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$jc10,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Coup is Justified when Crime is High (row)
 & Receives Remittances (col)")) 

```



```{r jc10ccc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$jc10,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Coup is Justified when Crime is High (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Coup is Justified when Corruption is High
__Interpretation Hint__: NA


Single choice question 


```{r jc13.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$jc13))
nresp <- sum(frequ$Freq)
frequ[ ,1] = factor(frequ[ ,1],levels(frequ[ ,1])[order(frequ$Freq, decreasing = FALSE)])
frequ <- frequ[ order(frequ[ , 1]) ,  ]
names(frequ)[1] <- "jc13"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$jc13, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$jc13,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ jc13, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
frequ3[ ,1] = factor(frequ3[ ,1],levels(frequ3[ ,1])[order(frequ3$mean, decreasing = FALSE)])
frequ3 <- frequ3[ order(frequ3[ , 1]) ,  ]
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Coup is Justified when Corruption is High",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r jc131.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~jc13 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Coup is Justified when Corruption is High (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r jc132.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~jc13 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Coup is Justified when Corruption is High (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r jc133.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~jc13 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Coup is Justified when Corruption is High (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r jc13ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$jc13,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Coup is Justified when Corruption is High (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r jc13ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$jc13,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Coup is Justified when Corruption is High (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r jc13ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$jc13,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Coup is Justified when Corruption is High (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r jc13ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$jc13,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Coup is Justified when Corruption is High (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r jc13ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$jc13,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Coup is Justified when Corruption is High (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r jc13ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$jc13,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Coup is Justified when Corruption is High (row)
 & Basic Rights are Protected (col)")) 

```



```{r jc13ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$jc13,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Coup is Justified when Corruption is High (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r jc13ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$jc13,MainDataFrame$q10a)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Coup is Justified when Corruption is High (row)
 & Receives Remittances (col)")) 

```



```{r jc13ccc9.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$jc13,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Coup is Justified when Corruption is High (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Executive Justified in Governing without Legislature
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Justified for the Executive to Dissolve the Supreme Court
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Satisfaction with Democracy
__Interpretation Hint__: NA


Single choice question 


```{r pn4.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=4, size="small"}

##Compute contingency table
frequ <- as.data.frame(table(MainDataFrame$pn4))
nresp <- sum(frequ$Freq)
list.ordinal <- unique(dico[ dico$listname == "pn4" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ$Var1) <- list.ordinal
names(frequ)[1] <- "pn4"
## Frequency table with NA in order to get non response rate
frequ1 <- as.data.frame(prop.table(table(MainDataFrame$pn4, useNA = "ifany")))
frequ1 <- frequ1[!(is.na(frequ1$Var1)), ]
frequ1 <- frequ1[!(frequ1$Var1 == "NA"), ]
percentreponse <- paste0(round(sum(frequ1$Freq)*100,digits = 1),"%")
## Frequency table without NA
frequ2 <- as.data.frame(prop.table(table(MainDataFrame$pn4,useNA = "no")))
## Frequency table with weight
frequ.weight <- as.data.frame(svymean(~ pn4, design = MainDataFrame.survey, na.rm = TRUE))
## Binding the two
frequ3 <- cbind(frequ2,frequ.weight)
## Reorder factor
list.ordinal <- unique(dico[ dico$listname == "pn4" & dico$type == "select_one_d", c("labelchoice") ])$labelchoice
levels(frequ3$Var1) <- list.ordinal
frequ3[ ,5] <- paste0(round(frequ3[ ,3]*100,digits = 1),"%")
names(frequ3)[5] <- "freqper2"
frequ3 <- cbind(frequ3,frequ[, 2])
names(frequ3)[6] <- "count"


## and now the graph
plot1 <- ggplot(frequ3, aes(x = frequ3$Var1, y = frequ3$mean)) +
geom_bar(fill = "#2a87c8", colour = "#2a87c8", stat = "identity", width = .8) +
geom_errorbar(aes(ymin = mean-SE, ymax = mean+SE), size=.4, width=.3, colour = 'grey20') +
guides(fill = FALSE) +
geom_label_repel(aes(y = mean, label = freqper2), fill = "#2a87c8", color = 'white') +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
xlab("") +
coord_flip() +
labs(title = "Satisfaction with Democracy",
subtitle = paste0(" Question response rate: ",percentreponse,"  - respondents: ", nresp),
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```








### Cross-tabulations



```{r pn41.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~pn4 + q1, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Satisfaction with Democracy (color)",
subtitle = " By question: Sex (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r pn42.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~pn4 + pais, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Satisfaction with Democracy (color)",
subtitle = " By question: Country (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




```{r pn43.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}

crosssfrequ.weight <- as.data.frame(prop.table(survey::svytable(~pn4 + year, design = MainDataFrame.survey  ), margin = 2))
names(crosssfrequ.weight)[1] <- "quest"
names(crosssfrequ.weight)[2] <- "disag"
crosssfrequ.weight$Freq2 <- paste0(round(crosssfrequ.weight$Freq*100,digits = 1),"%")
## Reorder factor
cross <- dcast(crosssfrequ.weight, disag  ~ quest, value.var = "Freq")
cross <- cross[ order(cross[ ,2], decreasing = FALSE) ,  ]
crosssfrequ.weight$disag <- factor(crosssfrequ.weight$disag, levels = as.character(cross[ ,1]))


## and now the graph
plot1 <- ggplot(crosssfrequ.weight, aes(fill = crosssfrequ.weight$quest, y = crosssfrequ.weight$Freq, x = crosssfrequ.weight$disag)) +
geom_bar(colour = "white", stat = "identity", width = .8, aes(fill = quest), position = position_stack(reverse = TRUE)) +
ylab("Frequency") +
scale_y_continuous(labels = percent) +
scale_fill_viridis(discrete = TRUE) +
xlab("") +
coord_flip() +
labs(title = "Satisfaction with Democracy (color)",
subtitle = " By question: year (bar)",
caption = paste0("Latin American Public Opinion Project- ",
                                  nrow(MainDataFrame), " total records collected between ",
                                  min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                  max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
theme(legend.direction = "horizontal", legend.position = "bottom", legend.box = "horizontal",legend.title = element_blank()  ) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```







### Significant Associations (chi-square with p value < 5%)



```{r pn4ccc1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$pn4,MainDataFrame$exc11)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Satisfaction with Democracy (row)
 & Asked to Pay Bribe to Process Document in Municipality (col)")) 

```



```{r pn4ccc2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$pn4,MainDataFrame$exc15)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Satisfaction with Democracy (row)
 & Asked to Pay a Bribe to use Public Health Services (col)")) 

```



```{r pn4ccc3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$pn4,MainDataFrame$exc16)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Satisfaction with Democracy (row)
 & Asked to Pay a Bribe at School (col)")) 

```



```{r pn4ccc4.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$pn4,MainDataFrame$exc2)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Satisfaction with Democracy (row)
 & Police Officer Asked for a Bribe (col)")) 

```



```{r pn4ccc5.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$pn4,MainDataFrame$b1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Satisfaction with Democracy (row)
 & Courts Guarantee Fair Trial (col)")) 

```



```{r pn4ccc6.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$pn4,MainDataFrame$b3)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Satisfaction with Democracy (row)
 & Basic Rights are Protected (col)")) 

```



```{r pn4ccc7.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$pn4,MainDataFrame$lib1)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Satisfaction with Democracy (row)
 & Level of Freedom of the Press Today (col)")) 

```



```{r pn4ccc8.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=6, size="small"}

corrplot(stats::chisq.test(MainDataFrame$pn4,MainDataFrame$q14)$residuals,
is.cor = FALSE, # use for general matrix to convert to Sq form
cl.pos = "n", ## Do not display the color legend
cl.cex = 0.7, # Size of all label
tl.cex = 0.7, # Size of axis label
tl.srt = 45, # string rotation in degrees
tl.col = "black", # color of text label.
col = brewer.pal(n = 2, name = "RdBu"), ## Change color
mar = c(0.5,0.5,4, 0.5), ## margin of plots
title = paste0("Statistical Association (positive=blue, negative= red) between
Satisfaction with Democracy (row)
 & Intends to Live or Work Abroad (col)")) 

```



 
## Support for mano dura policies (1=iron fist, 2=broad participation)
__Interpretation Hint__: NA


Numeric question  


```{r dem11.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=4, size="small"}


MainDataFrame$dem11 <- as.numeric(MainDataFrame$dem11)
frequ <- as.data.frame(table(MainDataFrame$dem11))
average <- as.data.frame(survey::svymean(~ dem11, design = MainDataFrame.survey, na.rm = TRUE))
data.outlier <- MainDataFrame$dem11
data.nooutlier <- as.data.frame(MainDataFrame$dem11)
qnt <- stats::quantile(data.outlier, probs = c(.25, .75), na.rm = T)
caps.df <- as.data.frame(stats::quantile(data.outlier, probs = c(.05, .95), na.rm = T))
H  <- 1.5 * stats::IQR(data.outlier, na.rm = T)
data.nooutlier[(data.nooutlier < (qnt[1] - H)) & !(is.na(data.nooutlier))  ] <- caps.df[1,1]
data.nooutlier[ (data.nooutlier > (qnt[2] + H)) & !(is.na(data.nooutlier)) ] <- caps.df[2,1]
names(data.nooutlier)[1] <- "variable"
plot1 <- ggplot(data = data.nooutlier, aes(x = data.nooutlier$variable)) +
geom_histogram(color = "white",fill = "#2a87c8", breaks = pretty(data.nooutlier$variable, n = nclass.Sturges(data.nooutlier$variable),min.n = 1)) +
labs(x = "", y = "Count") +
labs(title = "Support for mano dura policies (1=iron fist, 2=broad participation)",
subtitle = "After data capping treatement:
"
,
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_histo()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```


### Analysis of relationship

```{r dem11x1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}



plot1 <- ggplot(MainDataFrame, aes(y=MainDataFrame$dem11 , x=MainDataFrame$q1)) +
geom_boxplot(fill = "#2a87c8",colour = "black") + 
scale_size_area(max_size = 10) +
guides(fill = FALSE) +
xlab("") +
ylab("") +
coord_flip() +
scale_y_continuous(breaks = pretty_breaks()) +
labs(title = "Support for mano dura policies (1=iron fist, 2=broad participation)",
subtitle = "by question: Sex",
caption = paste0("Latin American Public Opinion Project- ",
                                 nrow(MainDataFrame), " total records collected between ",
                                 min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                 max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)
## Boxplot
plot1 <- ggplot(MainDataFrame, aes(y=data.nooutlier$variable, x= MainDataFrame$q1)) +
geom_boxplot(fill = "#2a87c8",colour = "black") +  #notch=TRUE
scale_size_area(max_size = 10) +
guides(fill = FALSE) +
xlab("") +
ylab("") +
coord_flip() +
scale_y_continuous(breaks = pretty_breaks()) +
labs(title = "Support for mano dura policies (1=iron fist, 2=broad participation)",
subtitle = "After data capping treatement. By question: Sex",
caption = paste0("Latin American Public Opinion Project- ",
                                      nrow(MainDataFrame), " total records collected between ",
                                      min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                      max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```



```{r dem11x2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}



plot1 <- ggplot(MainDataFrame, aes(y=MainDataFrame$dem11 , x=MainDataFrame$pais)) +
geom_boxplot(fill = "#2a87c8",colour = "black") + 
scale_size_area(max_size = 10) +
guides(fill = FALSE) +
xlab("") +
ylab("") +
coord_flip() +
scale_y_continuous(breaks = pretty_breaks()) +
labs(title = "Support for mano dura policies (1=iron fist, 2=broad participation)",
subtitle = "by question: Country",
caption = paste0("Latin American Public Opinion Project- ",
                                 nrow(MainDataFrame), " total records collected between ",
                                 min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                 max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)
## Boxplot
plot1 <- ggplot(MainDataFrame, aes(y=data.nooutlier$variable, x= MainDataFrame$pais)) +
geom_boxplot(fill = "#2a87c8",colour = "black") +  #notch=TRUE
scale_size_area(max_size = 10) +
guides(fill = FALSE) +
xlab("") +
ylab("") +
coord_flip() +
scale_y_continuous(breaks = pretty_breaks()) +
labs(title = "Support for mano dura policies (1=iron fist, 2=broad participation)",
subtitle = "After data capping treatement. By question: Country",
caption = paste0("Latin American Public Opinion Project- ",
                                      nrow(MainDataFrame), " total records collected between ",
                                      min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                      max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```



```{r dem11x3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}



plot1 <- ggplot(MainDataFrame, aes(y=MainDataFrame$dem11 , x=MainDataFrame$year)) +
geom_boxplot(fill = "#2a87c8",colour = "black") + 
scale_size_area(max_size = 10) +
guides(fill = FALSE) +
xlab("") +
ylab("") +
coord_flip() +
scale_y_continuous(breaks = pretty_breaks()) +
labs(title = "Support for mano dura policies (1=iron fist, 2=broad participation)",
subtitle = "by question: year",
caption = paste0("Latin American Public Opinion Project- ",
                                 nrow(MainDataFrame), " total records collected between ",
                                 min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                 max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)
## Boxplot
plot1 <- ggplot(MainDataFrame, aes(y=data.nooutlier$variable, x= MainDataFrame$year)) +
geom_boxplot(fill = "#2a87c8",colour = "black") +  #notch=TRUE
scale_size_area(max_size = 10) +
guides(fill = FALSE) +
xlab("") +
ylab("") +
coord_flip() +
scale_y_continuous(breaks = pretty_breaks()) +
labs(title = "Support for mano dura policies (1=iron fist, 2=broad participation)",
subtitle = "After data capping treatement. By question: year",
caption = paste0("Latin American Public Opinion Project- ",
                                      nrow(MainDataFrame), " total records collected between ",
                                      min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                      max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```





 
## Support for democracy or dictatorship (1=either is OK, 2=democracy, 3=dictatorsh
__Interpretation Hint__: NA


Numeric question  


```{r dem2.tab, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=4, size="small"}


MainDataFrame$dem2 <- as.numeric(MainDataFrame$dem2)
frequ <- as.data.frame(table(MainDataFrame$dem2))
average <- as.data.frame(survey::svymean(~ dem2, design = MainDataFrame.survey, na.rm = TRUE))
data.outlier <- MainDataFrame$dem2
data.nooutlier <- as.data.frame(MainDataFrame$dem2)
qnt <- stats::quantile(data.outlier, probs = c(.25, .75), na.rm = T)
caps.df <- as.data.frame(stats::quantile(data.outlier, probs = c(.05, .95), na.rm = T))
H  <- 1.5 * stats::IQR(data.outlier, na.rm = T)
data.nooutlier[(data.nooutlier < (qnt[1] - H)) & !(is.na(data.nooutlier))  ] <- caps.df[1,1]
data.nooutlier[ (data.nooutlier > (qnt[2] + H)) & !(is.na(data.nooutlier)) ] <- caps.df[2,1]
names(data.nooutlier)[1] <- "variable"
plot1 <- ggplot(data = data.nooutlier, aes(x = data.nooutlier$variable)) +
geom_histogram(color = "white",fill = "#2a87c8", breaks = pretty(data.nooutlier$variable, n = nclass.Sturges(data.nooutlier$variable),min.n = 1)) +
labs(x = "", y = "Count") +
labs(title = "Support for democracy or dictatorship (1=either is OK, 2=democracy, 3=dictatorsh",
subtitle = "After data capping treatement:
"
,
caption = paste0("Latin American Public Opinion Project- ",
                            nrow(MainDataFrame), " total records collected between ",
                            min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                            max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_histo()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```


### Analysis of relationship

```{r dem2x1.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}



plot1 <- ggplot(MainDataFrame, aes(y=MainDataFrame$dem2 , x=MainDataFrame$q1)) +
geom_boxplot(fill = "#2a87c8",colour = "black") + 
scale_size_area(max_size = 10) +
guides(fill = FALSE) +
xlab("") +
ylab("") +
coord_flip() +
scale_y_continuous(breaks = pretty_breaks()) +
labs(title = "Support for democracy or dictatorship (1=either is OK, 2=democracy, 3=dictatorsh",
subtitle = "by question: Sex",
caption = paste0("Latin American Public Opinion Project- ",
                                 nrow(MainDataFrame), " total records collected between ",
                                 min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                 max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)
## Boxplot
plot1 <- ggplot(MainDataFrame, aes(y=data.nooutlier$variable, x= MainDataFrame$q1)) +
geom_boxplot(fill = "#2a87c8",colour = "black") +  #notch=TRUE
scale_size_area(max_size = 10) +
guides(fill = FALSE) +
xlab("") +
ylab("") +
coord_flip() +
scale_y_continuous(breaks = pretty_breaks()) +
labs(title = "Support for democracy or dictatorship (1=either is OK, 2=democracy, 3=dictatorsh",
subtitle = "After data capping treatement. By question: Sex",
caption = paste0("Latin American Public Opinion Project- ",
                                      nrow(MainDataFrame), " total records collected between ",
                                      min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                      max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```



```{r dem2x2.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=3, size="small"}



plot1 <- ggplot(MainDataFrame, aes(y=MainDataFrame$dem2 , x=MainDataFrame$pais)) +
geom_boxplot(fill = "#2a87c8",colour = "black") + 
scale_size_area(max_size = 10) +
guides(fill = FALSE) +
xlab("") +
ylab("") +
coord_flip() +
scale_y_continuous(breaks = pretty_breaks()) +
labs(title = "Support for democracy or dictatorship (1=either is OK, 2=democracy, 3=dictatorsh",
subtitle = "by question: Country",
caption = paste0("Latin American Public Opinion Project- ",
                                 nrow(MainDataFrame), " total records collected between ",
                                 min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                 max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)
## Boxplot
plot1 <- ggplot(MainDataFrame, aes(y=data.nooutlier$variable, x= MainDataFrame$pais)) +
geom_boxplot(fill = "#2a87c8",colour = "black") +  #notch=TRUE
scale_size_area(max_size = 10) +
guides(fill = FALSE) +
xlab("") +
ylab("") +
coord_flip() +
scale_y_continuous(breaks = pretty_breaks()) +
labs(title = "Support for democracy or dictatorship (1=either is OK, 2=democracy, 3=dictatorsh",
subtitle = "After data capping treatement. By question: Country",
caption = paste0("Latin American Public Opinion Project- ",
                                      nrow(MainDataFrame), " total records collected between ",
                                      min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                      max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```



```{r dem2x3.rel, echo=FALSE, warning=FALSE, cache=FALSE, tidy = TRUE, message=FALSE, comment = "", fig.height=7, size="small"}



plot1 <- ggplot(MainDataFrame, aes(y=MainDataFrame$dem2 , x=MainDataFrame$year)) +
geom_boxplot(fill = "#2a87c8",colour = "black") + 
scale_size_area(max_size = 10) +
guides(fill = FALSE) +
xlab("") +
ylab("") +
coord_flip() +
scale_y_continuous(breaks = pretty_breaks()) +
labs(title = "Support for democracy or dictatorship (1=either is OK, 2=democracy, 3=dictatorsh",
subtitle = "by question: year",
caption = paste0("Latin American Public Opinion Project- ",
                                 nrow(MainDataFrame), " total records collected between ",
                                 min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                 max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)
## Boxplot
plot1 <- ggplot(MainDataFrame, aes(y=data.nooutlier$variable, x= MainDataFrame$year)) +
geom_boxplot(fill = "#2a87c8",colour = "black") +  #notch=TRUE
scale_size_area(max_size = 10) +
guides(fill = FALSE) +
xlab("") +
ylab("") +
coord_flip() +
scale_y_continuous(breaks = pretty_breaks()) +
labs(title = "Support for democracy or dictatorship (1=either is OK, 2=democracy, 3=dictatorsh",
subtitle = "After data capping treatement. By question: year",
caption = paste0("Latin American Public Opinion Project- ",
                                      nrow(MainDataFrame), " total records collected between ",
                                      min(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " and ",
                                      max(as.Date(MainDataFrame$today, format = "%Y-%m-%d")), " in ", " NA ")) +
unhcRstyle::unhcr_style_bar()
ggpubr::ggarrange(kobo_left_align(plot1, c("caption", "subtitle", "title")), ncol = 1, nrow = 1)

```




#  The Economy


 
## Has Run Out of Food in Last 3 Months
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Has Gone without Meals in the Last 3 Months
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Perception of Personal Economic Situation
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Household Income Over Last Two Years
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Government Must Spend More Helping Poor
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Unfair for Rich to Pay High Taxes but Receive Few Services
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Okay for Rich to Pay High Taxes
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Most Unemployed Could Find Job if Wanted
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Government Should Reduce Income Inequality
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.


 
## Evaluation of the Economy
__Interpretation Hint__: NA


Single choice question 


No responses  recorded for this question.

